# NTUTrainRL2_3
This is the lecture notes for NTU Train Course of R Project Lecture 2_3

## Geo Mapping

我們要用Leftlet for R來做地圖資料探勘分析，Leaflet是眾多JavaScript套件中很受歡迎的互動式地圖，知名網站[The New York Times](http://www.nytimes.com/projects/elections/2013/nyc-primary/mayor/map.html)與[The Washington Post](http://www.washingtonpost.com/sf/local/2013/11/09/washington-a-world-apart/)都是使用Leaflet.js。而Leaflet for R讓R語言使用者能夠跳過撰寫JavaScript來使用它。

### Leaflet for R

#### 簡介

你的第一個地圖helloMap

```{r}
#安裝並且載入leaflet與magrittr這兩個套件
packs <- c("leaflet", "magrittr")
for (i in 1:length(packs)){
  install.packages(packs[i])
}
sapply(packs, library, character.only=T)

helloMap <- leaflet() %>%
  addTiles() %>% #把預設的地圖圖層加入
  addMarkers(lng=121.539366, lat=25.017326, popup="National Taiwan University")
helloMap

# 如果你不習慣使用pipe run %>%
helloMap <- addMarkers(addTiles(leaflet()), lng=121.539366, lat=25.017326, popup="National Taiwan University")
helloMap
```

#### 基本地圖

`setView()`用來設定地圖中心與縮放比例。

```{r}
baseMap <- leaflet() %>% 
  setView(lng = 121.539366, lat = 25.017326, zoom = 14) %>% 
  addTiles()
baseMap
```

`addTiles()`使用預設的[OpenStreetMap](https://www.openstreetmap.org/#map=5/51.500/-0.100);`addProviderTiles()`可以使用其他的[leaflet-provider plugin](http://leaflet-extras.github.io/leaflet-providers/preview/index.html)，注意其中有些地圖可能要在該專案註冊才能呼叫。

```{r}
#Stamen
providerMap <- leaflet() %>%
  setView(lng = 121.539366, lat = 25.017326, zoom = 10) %>%
  addProviderTiles("Stamen.TonerLite")
providerMap

#Thunderforest
providerMap <- leaflet() %>%
  setView(lng = 121.539366, lat = 25.017326, zoom = 10) %>%
  addProviderTiles("Thunderforest.OpenCycleMap")
providerMap
```

我們也可以結合多個**Provider Tiles**，使用`options`來指定圖層的透明度。

```{r}
combineMap <- leaflet() %>%
  setView(lng = 121.539366, lat = 25.017326, zoom = 10) %>%
  addProviderTiles("Stamen.TonerLite") %>%
  addProviderTiles("Thunderforest.OpenCycleMap",
    options = providerTileOptions(opacity = 0.5))
combineMap
```

#### 標記

`addMarkers()`用來新增地點的標記與點擊後出現的訊息。

```{r}
markerNTU <- leaflet() %>%
  addTiles() %>%
  addMarkers(lng=121.539366, lat=25.017326, popup="National Taiwan University")
markerNTU
```

用台北市的7-11來做範例。

```{r}
Sys.setlocale(category="LC_ALL", locale="")
#stores711inTP <- read.table("C:/NTUTrainRL2/data/stores711inTP.csv", header=T, sep=",", stringsAsFactors=F)

stores711inTPMap <- readRDS("C:/NTUTrainRL2/data/stores711inTP.rds")

markers711 <- leaflet(data=stores711inTPMap) %>%
  addTiles() %>%
  addMarkers(~lng, ~lat, popup=~popups)
markers711
```

#### 說明

#### 路徑與範圍

#### JSON資料格式

#### Raster Images

#### 與Shiny整合

#### 顏色

#### 圖例

#### 圖層

## Reference
* R in Action, Robert I. Kabacoff
* R Graphics Cookbook, Winston Chang
* Leaflet for R

&copy; Tony Yao-Jen Kuo 2015